From 13db0b6fe5a12f05fd890877cb4715d7b862fc02 Mon Sep 17 00:00:00 2001
From: jacob431 <jacob_wu@asus.com>
Date: Fri, 11 Dec 2020 18:07:57 +0800
Subject: [PATCH 1/2] Upgrade to Dunfell

---
 conf/layer.conf                            | 2 ++
 conf/local.conf.sample                     | 2 +-
 conf/machine/include/up-common.inc         | 2 ++
 conf/machine/up-board.conf                 | 2 +-
 conf/machine/up-core-plus.conf             | 2 +-
 conf/machine/up-core.conf                  | 2 +-
 conf/machine/up-squared.conf               | 2 +-
 conf/machine/up-xtreme.conf                | 2 +-
 recipes-core/images/upboard-image-sato.inc | 1 -
 9 files changed, 10 insertions(+), 7 deletions(-)
 mode change 100644 => 100755 conf/layer.conf
 mode change 100644 => 100755 conf/local.conf.sample
 mode change 100644 => 100755 conf/machine/include/up-common.inc
 mode change 100644 => 100755 conf/machine/up-board.conf
 mode change 100644 => 100755 conf/machine/up-core-plus.conf
 mode change 100644 => 100755 conf/machine/up-core.conf
 mode change 100644 => 100755 conf/machine/up-squared.conf
 mode change 100644 => 100755 conf/machine/up-xtreme.conf
 mode change 100644 => 100755 recipes-core/images/upboard-image-sato.inc

diff --git a/conf/layer.conf b/conf/layer.conf
old mode 100644
new mode 100755
index ba426bc..88e7269
--- a/conf/layer.conf
+++ b/conf/layer.conf
@@ -11,4 +11,6 @@ BBFILE_PRIORITY_up-board = "6"
 
 LAYERDEPENDS_up-board = "intel"
 
+LAYERSERIES_COMPAT_up-board = "dunfell"
+
 BBMASK += "meta-virtualization/recipes-extended/iasl/iasl_20160527.bb"
diff --git a/conf/local.conf.sample b/conf/local.conf.sample
old mode 100644
new mode 100755
index 83bde17..ac5191a
--- a/conf/local.conf.sample
+++ b/conf/local.conf.sample
@@ -230,7 +230,7 @@ DISTRO_FEATURES_BACKFILL_CONSIDERED = "sysvinit"
 DISTRO_FEATURES_append = " virtualization"
 
 # Added Docker container to the image
-IMAGE_INSTALL_append = "  docker docker-contrib python3-docker-compose"
+IMAGE_INSTALL_append = " docker python3-docker-compose"
 
 PREFERRED_PROVIDER_iasl-native = "acpica-native"
 
diff --git a/conf/machine/include/up-common.inc b/conf/machine/include/up-common.inc
old mode 100644
new mode 100755
index 33f4567..b2aa368
--- a/conf/machine/include/up-common.inc
+++ b/conf/machine/include/up-common.inc
@@ -15,5 +15,7 @@ GLIBC_ADDONS = "nptl"
 
 SERIAL_CONSOLES="115200;ttyS0"
 
+IMAGE_FSTYPES += " hddimg"
+
 WKS_FILE = "${@bb.utils.contains_any("EFI_PROVIDER", "systemd-boot rmc-boot", "systemd-bootdisk-initrd.wks", "grub-bootdisk-initrd.wks", d)}"
 WKS_FILE_DEPENDS_append += " acpi-tables"
diff --git a/conf/machine/up-board.conf b/conf/machine/up-board.conf
old mode 100644
new mode 100755
index 669bd8e..b0f231c
--- a/conf/machine/up-board.conf
+++ b/conf/machine/up-board.conf
@@ -4,7 +4,7 @@
 #@DESCRIPTION: Machine configuration for UP board systems
 
 PREFERRED_PROVIDER_virtual/kernel ?= "linux-intel"
-PREFERRED_VERSION_linux-intel ?= "4.19%"
+PREFERRED_VERSION_linux-intel ?= "5.4%"
 
 require conf/machine/include/up-common.inc
 
diff --git a/conf/machine/up-core-plus.conf b/conf/machine/up-core-plus.conf
old mode 100644
new mode 100755
index 4366d25..8b6e92e
--- a/conf/machine/up-core-plus.conf
+++ b/conf/machine/up-core-plus.conf
@@ -5,7 +5,7 @@
 #@DESCRIPTION: Machine configuration for UP Core Plus systems
 
 PREFERRED_PROVIDER_virtual/kernel ?= "linux-intel"
-PREFERRED_VERSION_linux-intel ?= "4.19%"
+PREFERRED_VERSION_linux-intel ?= "5.4%"
 
 require conf/machine/include/up-common.inc
 
diff --git a/conf/machine/up-core.conf b/conf/machine/up-core.conf
old mode 100644
new mode 100755
index f8164ea..889d590
--- a/conf/machine/up-core.conf
+++ b/conf/machine/up-core.conf
@@ -5,7 +5,7 @@
 #@DESCRIPTION: Machine configuration for UP Core systems
 
 PREFERRED_PROVIDER_virtual/kernel ?= "linux-intel"
-PREFERRED_VERSION_linux-intel ?= "4.19%"
+PREFERRED_VERSION_linux-intel ?= "5.4%"
 
 require conf/machine/include/up-common.inc
 
diff --git a/conf/machine/up-squared.conf b/conf/machine/up-squared.conf
old mode 100644
new mode 100755
index 55cff8e..08ed4b2
--- a/conf/machine/up-squared.conf
+++ b/conf/machine/up-squared.conf
@@ -5,7 +5,7 @@
 #@DESCRIPTION: Machine configuration for UP Squared systems
 
 PREFERRED_PROVIDER_virtual/kernel ?= "linux-intel"
-PREFERRED_VERSION_linux-intel ?= "4.19%"
+PREFERRED_VERSION_linux-intel ?= "5.4%"
 
 require conf/machine/include/up-common.inc
 
diff --git a/conf/machine/up-xtreme.conf b/conf/machine/up-xtreme.conf
old mode 100644
new mode 100755
index a503caf..e5d26c9
--- a/conf/machine/up-xtreme.conf
+++ b/conf/machine/up-xtreme.conf
@@ -4,7 +4,7 @@
 #@DESCRIPTION: Machine configuration for UP board systems
 
 PREFERRED_PROVIDER_virtual/kernel ?= "linux-intel"
-PREFERRED_VERSION_linux-intel ?= "4.19%"
+PREFERRED_VERSION_linux-intel ?= "5.4%"
 
 require conf/machine/include/up-common.inc
 
diff --git a/recipes-core/images/upboard-image-sato.inc b/recipes-core/images/upboard-image-sato.inc
old mode 100644
new mode 100755
index f5f5be8..05e300c
--- a/recipes-core/images/upboard-image-sato.inc
+++ b/recipes-core/images/upboard-image-sato.inc
@@ -3,7 +3,6 @@ IMAGE_FEATURES += "package-management"
 
 IMAGE_INSTALL += "kernel-modules"
 IMAGE_INSTALL += "dmidecode"
-IMAGE_INSTALL += "python"
 IMAGE_INSTALL += "python3"
 IMAGE_INSTALL += "python3-pip"
 IMAGE_INSTALL += "alsa-lib alsa-utils alsa-tools"
-- 
2.7.4

